import pefile
import sys

malware_file = sys.argv[1]
pe = pefile.PE(malware_file)

al_one = []
al_two = []
offsets = []

rule_num_one = ""
rule_num_two = ""

if hasattr(pe, 'DIRECTORY_ENTRY_EXPORT'):
    for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols:
        print("%s \t %s \t %s"  % (hex(exp.address + pe.OPTIONAL_HEADER.ImageBase), exp.name, exp.ordinal))
        rule_one_address_list.append(exp.address + pe.OPTIONAL_HEADER.ImageBase)
        rule_two_address_list.append(exp.address + pe.OPTIONAL_HEADER.ImageBase)

    for address in al_one:
            if al_one.count(address) >= 3:
                     rule_num_one = "Malware has been detected because it violated rule number 1"
                     
    rule_two_address_list.sort()

    for i in range(len(al_two)):
            if i + 1 < len(al_two):
                offsets.append(al_two[i + 1] - al_two[i])
                
    for offset in offsets:
        if offset != 0:
            if offsets.count(offset) >=3:
                rule_num_two = "Malware has been detected because it violated rule number 2"
print(rule_num_one)
print(rule_num_two)


        
